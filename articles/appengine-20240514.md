---
title: "【Google Cloud】App Engine解説"
emoji: "😎"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["GoogleCloud", "AppEngine"]
published: false
---

# App Engineについて
App Engineはフルマネージドなアプリケーション実行環境を提供するPaaSになります。
Google Cloudが一番初めに出したサービスになります。（歴史がありますね。）
2008年リリースということなので、16年くらい稼働しているサービスになります。

https://ja.wikipedia.org/wiki/Google_App_Engine

https://cloud.google.com/blog/ja/products/gcp/reflecting-on-our-ten-year-app-engine-journey

# App Engineを構成する要素
App Engineはいくつかのコンポーネントから構成されています。

## アプリケーション
アプリケーションコンポーネントは、App Engineを構成する各コンポーネントの親に相当し、App Engineアプリケーション配下に、サービス、バージョン、インスタンスが階層的に存在します。App Engineはリージョンリソースのため、アプリケーションを作成する際にはどこのリージョンで作成するか求められます。アプリケーション作成時に選択したリージョンは変更することができませんので、注意してください。

## サービス
サービスはアプリケーションを論理コンポーネントとして分解できます。単一のサービスを構成することも、複数のサービスを作成しサービス間での通信をすることでマイクロサービスとして構成することも可能です。
各サービスはアプリのソースコードと、対応するApp Engine構成ファイルで構成され、サービスに対してデプロイを行うと後述するバージョンが追加で作成されていきます。

## バージョン
バージョンはサービス内で稼働しているアプリの実態です。各サービス内には複数のバージョンが登録され、「トラフィックの移行」を行うことによって即座にロールバックができたり、テストバージョンに切り替えられたりすることができます。また、「トラフィックの分割」も行うことができるため、複数のバージョンにトラフィックをルーティングさせることができます。

複数のバージョンで利用されるため、アプリケーションのリクエストURLは以下の仕様で決定されます。

```
https://VERSION-dot-SERVICE-dot-PROJECT_ID.REGION_ID.r.appspot.com
```

## インスタンス
インスタンスはサービスの各バージョンが実行されている基盤になります。App Engineの環境によってインスタンスの実行基盤が異なります。スタンダード環境の場合は、ユーザ側の環境ではなくGoogle Cloud側の環境のコンテナインスタンスで実行されます。フレキシブル環境の場合は、ユーザ側の環境のCompute Engine上のDockerコンテナ内で実行されます。

# App Engineの環境
App Engineでアプリケーションを実行する環境として、スタンダード環境とフレキシブル環境の2つがあります。それぞれ特徴がありますので以下にまとめます。

|                      機能                      |                スタンダード環境                |          フレキシブル環境          |
| ---------------------------------------------- | ---------------------------------------------- | ---------------------------------- |
| インスタンスの起動時間                         | 秒                                             | 分                                 |
| リクエストの最大タイムアウト                   | ランタイムとスケーリングのタイプによって異なる | 60分                               |
| バックグラウンドスレッド                       | 〇 （制限付き）                                | 〇                                 |
| バックグラウンドプロセス                       | ×                                              | 〇                                 |
| SSHデバッグ                                    | ×                                              | 〇                                 |
| スケーリング                                   | 手動、基本、自動                               | 手動、自動                         |
| ローカル ディスクへの書き込み                  | Python 2.7 と PHP 5.5以外で/tmpへ可能          | VM起動時の初期化されたディスク     |
| ランタイムの変更                               | ×                                              | 〇 （Dockerfile経由）              |
| デプロイ時間                                   | 秒                                             | 分                                 |
| Google Cloud APIとサービスへのアクセス         | 〇                                             | 〇                                 |
| WebSocket                                      | ×                                              | 〇                                 |
| サードパーティ バイナリのインストール サポート | Python 2.7 と PHP 5.5以外で可能                | 〇                                 |
| 料金                                           | インスタンス時間                               | vCPU、メモリ、永続ディスクの使用量 |


## スタンダード環境

## フレキシブル環境