---
title: ""
emoji: "ğŸ“Œ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: []
published: false
---
# ã¯ã˜ã‚ã«
ã“ã‚“ã«ã¡ã¯ã€‚championã§ã™ã€‚
æ™®æ®µã¯ã€Google Cloudã‚„AWSã‚’ä¸­å¿ƒã¨ã—ãŸã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã®è¨­è¨ˆï½ä¿å®ˆé‹ç”¨ã‚’è¡Œãªã£ã¦ã„ã¾ã™ã€‚

å€‹äººçš„ã«å¹´æ˜ã‘ã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒŠæŠ€è¡“ã«å†å…¥é–€ä½¿ç”¨ã¨ã„ã†ä¼ç”»ã‚’ã‚„ã£ã¦ã„ã¾ã™ã€‚
Google Cloudã®Cloud Runã‚„ã€AWSã®ECSã§ã‚‚åˆ©ç”¨ã•ã‚Œã‚‹Dockerã¨ã„ã†æŠ€è¡“ã§ã™ãŒã€Dockerã«ã¤ã„ã¦å†åº¦å¾©ç¿’ã‚’å…¼ã­ã¦ã¾ã¨ã‚ãŸã„ã¨æ€ã„ã¾ã™ã€‚

# Dockerã¨ã¯
Dockerã¯Dockerç¤¾ãŒé–‹ç™ºã‚’ã—ã¦ãŠã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ãã®å®Ÿè¡Œã«å¿…è¦ãªç’°å¢ƒã‚’ä¸€ã¤ã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åŒ–ã—ã€è»½é‡ã§å¯æ¬æ€§ã®é«˜ã„å®Ÿè¡Œç’°å¢ƒã‚’æä¾›ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒŠå‹ä»®æƒ³æŠ€è¡“ã§ã™ã€‚åŸºæœ¬çš„ã«ã¯ã€Dockerã‚¨ãƒ³ã‚¸ãƒ³ã¨å‘¼ã°ã‚Œã‚‹Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ãˆã—ã¦ã„ã‚Œã°ã€æ§˜ã€…ãªç’°å¢ƒã§Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãã®ãŸã‚ã€Dockerã¯é–‹ç™ºç’°å¢ƒã®å·®ç•°ã‚’å¸åã—ã¦ãã‚Œã€ç’°å¢ƒã®ä¸€è²«æ€§ã‚’ä¿ã¤ã“ã¨ãŒã§ãã¾ã™ã€‚

# ä»®æƒ³ãƒã‚·ãƒ³ã¨ã®é•ã„
ã‚³ãƒ³ãƒ†ãƒŠã¨ä»®æƒ³ãƒã‚·ãƒ³ã¯ã€ä¸¡æ–¹ãã‚Œãã‚Œã®ä¸­ã«ç‹¬ç«‹ã—ãŸãƒ—ãƒ­ã‚»ã‚¹å®Ÿè¡Œç’°å¢ƒã‚’æä¾›ã™ã‚‹ç‚¹ã¯åŒã˜ã§ã™ãŒã€ãƒ—ãƒ­ã‚»ã‚¹ã®ä¸‹ã«ã‚ã‚‹ã‚«ãƒ¼ãƒãƒ«ä»¥ä¸‹ã®ãƒ¬ã‚¤ãƒ¤ã«å¤§ããªé•ã„ãŒã‚ã‚‹
ã‚Šã¾ã™ã€‚ä»®æƒ³ãƒã‚·ãƒ³ã¯ã€å€‹ã€…ã®ä»®æƒ³ãƒã‚·ãƒ³ã¯å°‚ç”¨ã®ä»®æƒ³çš„ãªãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã¨ã‚«ãƒ¼ãƒãƒ«ã‚’ä½¿ã†ã®ã«å¯¾ã—ã¦ã€ã‚³ãƒ³ãƒ†ãƒŠã®å ´åˆã¯ã€ã‚³ãƒ³ãƒ†ãƒŠã‚’å‹•ã‹ã™ãƒ›ã‚¹ãƒˆOSã€ãŠã‚ˆã³å…¨ã‚³ãƒ³ãƒ†ãƒŠãŒ1ã¤ã®ã‚«ãƒ¼ãƒãƒ«ã‚’å…±æœ‰ã—ã¾ã™ã€‚

ä»®æƒ³ãƒã‚·ãƒ³ãŒèµ·å‹•ã™ã‚‹ã¾ã§ã®æµã‚Œã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ãŒã€

1. ãƒ›ã‚¹ãƒˆOSä¸Šã®ä»®æƒ³åŒ–ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãŒã€ä»®æƒ³ãƒã‚·ãƒ³ã‚’èµ·å‹•ã™ã‚‹ã€‚
2. GRUBãªã©ã®ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ãŒèµ·å‹•ã™ã‚‹
3. ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ãŒã‚«ãƒ¼ãƒãƒ«ã‚’èµ·å‹•ã™ã‚‹
4. ã‚«ãƒ¼ãƒãƒ«ãŒinitãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’èµ·å‹•ã™ã‚‹
5. initï¼ˆsystemdï¼‰ãƒ—ãƒ­ã‚»ã‚¹ãŒå„ç¨®ã‚µãƒ¼ãƒ“ã‚¹ã‚’ç«‹ã¡ä¸Šã’ã‚‹

ã‚³ãƒ³ãƒ†ãƒŠãŒèµ·å‹•ã™ã‚‹ã¾ã§ã®æµã‚Œã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚
1. ã‚³ãƒ³ãƒ†ãƒŠãƒ©ãƒ³ã‚¿ã‚¤ãƒ (Dockerd)ãŒã€ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œã‚‹
2. ã‚³ãƒ³ãƒ†ãƒŠãŒæœ€åˆã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç«‹ã¡ä¸Šã’ã‚‹

ä»®æƒ³ãƒã‚·ãƒ³ã¨æ¯”è¼ƒã™ã‚‹ã¨ã€èµ·å‹•ã™ã‚‹ã¾ã§ã®éç¨‹ãŒã‹ãªã‚ŠçŸ­ã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚
ãã®ãŸã‚ã€ã‚³ãƒ³ãƒ†ãƒŠã¯èµ·å‹•æ™‚é–“ãŒçŸ­ã„ã“ã¨ã‹ã‚‰ã€è¿…é€Ÿãªã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚


# Dockerã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
Dockerã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯ã€**ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ»ã‚µãƒ¼ãƒå‹**ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚
![Dockerã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](/images/docker-20250125/docker-architecture.png)
https://docs.docker.jp/get-started/overview.html#docker-architecture

Dockerã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ç™»å ´ã™ã‚‹ç”¨èªã«ã¤ã„ã¦è§£èª¬ã—ã¦ã„ãã¾ã™ã€‚

## Dockerã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
Dockerã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ã€Dockerãƒ‡ãƒ¼ãƒ¢ãƒ³ã¨ã‚„ã‚Šå–ã‚Šã™ã‚‹ãŸã‚ã«ãƒ¦ãƒ¼ã‚¶ãŒåˆ©ç”¨ã—ã¾ã™ã€‚**docker**CLIã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€Dockerãƒ‡ãƒ¼ãƒ¢ãƒ³ã«å¯¾ã—ã¦Dockerã®æ©Ÿèƒ½ã®å®Ÿè¡Œã‚’å‘½ä»¤ã—ã¾ã™ã€‚

## Dockerãƒ‡ãƒ¼ãƒ¢ãƒ³
Dockerãƒ‡ãƒ¼ãƒ¢ãƒ³ã¯ã€Dockerã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰å‘½ä»¤ã‚’å—ã‘ä»˜ã‘ã€Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã€ã‚³ãƒ³ãƒ†ãƒŠã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãªã©ã®Dockerã®æ©Ÿèƒ½ç¾¤ã‚’ç®¡ç†ãƒ»å®Ÿè¡Œã—ã¾ã™ã€‚

## Dockerãƒ¬ã‚¸ã‚¹ãƒˆãƒª
Dockerãƒ¬ã‚¸ã‚¹ãƒˆãƒªã¯ã€**Dockerã‚¤ãƒ¡ãƒ¼ã‚¸**ã‚’ç®¡ç†ã—ã¾ã™ã€‚**Docker Hub**ã®ã‚ˆã†ãªå…¬é–‹ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚‚ã‚ã‚Œã°ã€AWSã‚„Google Cloudã®ã‚ˆã†ãªã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ãŒæä¾›ã™ã‚‹ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚„ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚‚ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
Dockerãƒ‡ãƒ¼ãƒ¢ãƒ³ã¯ã€Dockerãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‹ã‚‰Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å–å¾—ã—ã¦ã€ãƒ›ã‚¹ãƒˆä¸Šã§Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‹ã‚‰Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

## Dockerã‚¤ãƒ¡ãƒ¼ã‚¸
Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã¯ã€Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œæˆã™ã‚‹å‘½ä»¤ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã“ã¨ã‚’è¨€ã„ã¾ã™ã€‚Dockerã‚³ãƒ³ãƒ†ãƒŠã¯Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ã‚‚ã¨ã«ä½œæˆã•ã‚Œã¾ã™ã€‚Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã¯ã€å…ˆè¿°ã—ãŸDockerãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã—ã€è‡ªèº«ã§ä½œæˆã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚è‡ªèº«ã§Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œæˆã™ã‚‹å ´åˆã¯ã€**Dockerfile**ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€Dockerfileã«Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œæˆã™ã‚‹ã¾ã§ã®å‘½ä»¤ã‚’è¨˜è¼‰ã—ã¾ã™ã€‚

## Dockerã‚³ãƒ³ãƒ†ãƒŠ
Dockerã‚³ãƒ³ãƒ†ãƒŠã¯ã€å…ˆè¿°ã—ãŸDockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‹ã‚‰ä½œæˆã•ã‚Œã‚‹å®Ÿè¡ŒçŠ¶æ…‹ã¨ãªã£ãŸã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ã“ã¨ã‚’è¨€ã„ã¾ã™ã€‚ã‚³ãƒ³ãƒ†ãƒŠã¯ã€Linuxã‚«ãƒ¼ãƒãƒ«ã®æ©Ÿèƒ½ã‚’åˆ©ç”¨ã—ã¦ç‹¬ç«‹ã—ãŸãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚„ã€ãƒ—ãƒ­ã‚»ã‚¹ãŒæä¾›ã•ã‚Œãƒ›ã‚¹ãƒˆãƒã‚·ãƒ³ä¸Šã§éš”é›¢ã•ã‚ŒãŸé ˜åŸŸã«ãªã‚Šã¾ã™ã€‚


# dockerã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
Rocky Linuxã«Dockerã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ãã¾ã™ã€‚

## Dockerãƒªãƒã‚¸ãƒˆãƒªã®è¿½åŠ 
Dockerç¤¾ãŒæä¾›ã™ã‚‹å…¬å¼ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’è¿½åŠ ã—ã¦ã„ãã¾ã™ã€‚
```bash
$ sudo dnf config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
Adding repo from: https://download.docker.com/linux/centos/docker-ce.repo
```

ãƒªãƒã‚¸ãƒˆãƒªä¸€è¦§ã‚’ç¢ºèªã—ã¦ã„ãã¾ã™ã€‚
```bash
$ sudo dnf repolist | grep Docker
docker-ce-stable                      Docker CE Stable - x86_64
```
ã“ã‚Œã§Rocky Linuxã«Dockerã®ãƒªãƒã‚¸ãƒˆãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã—ãŸã€‚

## Dockerã‚¨ãƒ³ã‚¸ãƒ³ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
Dockerã‚¨ãƒ³ã‚¸ãƒ³ã‚’ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ãã¾ã™ã€‚
```bash
$ sudo dnf -y install docker-ce docker-ce-cli containerd.io
```
ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã€**docker version**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸDockerã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ä»Šå›ã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³**27.5.1**ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã—ãŸã€‚
```bash
$ docker version
Client: Docker Engine - Community
 Version:           27.5.1
 API version:       1.47
 Go version:        go1.22.11
 Git commit:        9f9e405
 Built:             Wed Jan 22 13:42:47 2025
 OS/Arch:           linux/amd64
 Context:           default
Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?
```

## Dockerã®èµ·å‹•ç¢ºèªã¨è‡ªå‹•èµ·å‹•è¨­å®š
Dockerã‚¨ãƒ³ã‚¸ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç›´å¾Œã¯ã€Dockerãƒ‡ãƒ¼ãƒ¢ãƒ³ãŒèµ·å‹•ã—ã¦ã„ã¾ã›ã‚“ã€‚
```bash
$ sudo systemctl status docker
â—‹ docker.service - Docker Application Container Engine
     Loaded: loaded (/usr/lib/systemd/system/docker.service; disabled; preset: disabled)
     Active: inactive (dead)
TriggeredBy: â—‹ docker.socket
       Docs: https://docs.docker.com
```

ãã®ãŸã‚ã€**systemctl start**ã‚³ãƒãƒ³ãƒ‰ã‚’åˆ©ç”¨ã—ã¦ã€Dockerã®èµ·å‹•ã‚’è¡Œã£ã¦ã„ãã¾ã™ã€‚
```bash
$ sudo systemctl start docker
$ sudo systemctl status docker
â— docker.service - Docker Application Container Engine
     Loaded: loaded (/usr/lib/systemd/system/docker.service; disabled; preset: disabled)
     Active: active (running) since Fri 2025-01-24 23:17:49 UTC; 1s ago
TriggeredBy: â— docker.socket
       Docs: https://docs.docker.com
   Main PID: 78229 (dockerd)
      Tasks: 10
     Memory: 28.2M
        CPU: 207ms
     CGroup: /system.slice/docker.service
             â””â”€78229 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock

Jan 24 23:17:47 rocky dockerd[78229]: time="2025-01-24T23:17:47.956118145Z" level=info msg="Starting up"
Jan 24 23:17:47 rocky dockerd[78229]: time="2025-01-24T23:17:47.957371649Z" level=info msg="OTEL tracing is not>
Jan 24 23:17:48 rocky dockerd[78229]: time="2025-01-24T23:17:48.019630565Z" level=info msg="Loading containers:>
Jan 24 23:17:48 rocky dockerd[78229]: time="2025-01-24T23:17:48.059542785Z" level=info msg="Firewalld: created >
Jan 24 23:17:49 rocky dockerd[78229]: time="2025-01-24T23:17:49.309172007Z" level=info msg="Firewalld: interfac>
Jan 24 23:17:49 rocky dockerd[78229]: time="2025-01-24T23:17:49.642863119Z" level=info msg="Loading containers:>
Jan 24 23:17:49 rocky dockerd[78229]: time="2025-01-24T23:17:49.664401585Z" level=info msg="Docker daemon" comm>
Jan 24 23:17:49 rocky dockerd[78229]: time="2025-01-24T23:17:49.664710505Z" level=info msg="Daemon has complete>
Jan 24 23:17:49 rocky dockerd[78229]: time="2025-01-24T23:17:49.716290617Z" level=info msg="API listen on /run/>
Jan 24 23:17:49 rocky systemd[1]: Started Docker Application Container Engine.
```

Dockerã®èµ·å‹•ãŒç¢ºèªã§ããŸå¾Œã¯ã€å†èµ·å‹•å¾Œã‚‚è‡ªå‹•çš„ã«Dockerãƒ‡ãƒ¼ãƒ¢ãƒ³ãŒèµ·å‹•ã™ã‚‹ã‚ˆã†ã«ã€**systemctl enable**ã‚³ãƒãƒ³ãƒ‰ã‚’åˆ©ç”¨ã—ã¦è‡ªå‹•èµ·å‹•ã®è¨­å®šã‚’è¡Œãªã£ã¦ã„ãã¾ã™ã€‚

```bash
$ sudo systemctl enable docker
Created symlink /etc/systemd/system/multi-user.target.wants/docker.service â†’ /usr/lib/systemd/system/docker.service.

$ sudo systemctl is-enabled docker
enabled
```

## Dockerã‚°ãƒ«ãƒ¼ãƒ—ã¸ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’è¿½åŠ 
Dockerã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã¯ã€dockerã‚³ãƒãƒ³ãƒ‰ã¯rootæ¨©é™ã§ã—ã‹å®Ÿè¡Œã§ãã¾ã›ã‚“ã€‚**docker ps**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€**/var/run/docker.sock**ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®æ¨©é™ã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚
**/var/run/docker.sock**ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¨©é™ã‚’ç¢ºèªã™ã‚‹ã¨ã€rootã‹dockerã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ã«ã—ã‹æ¨©é™ãŒãªã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

```bash
$ docker ps
permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get "http://%2Fvar%2Frun%2Fdocker.sock/v1.47/containers/json": dial unix /var/run/docker.sock: connect: permission denied


$ ll /var/run/docker.sock 
srw-rw----. 1 root docker 0 Jan 24 23:17 /var/run/docker.sock
```
rootä»¥å¤–ã§ã‚‚dockerã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«è¨­å®šã—ã¦ã„ãã¾ã™ã€‚
è‡ªèº«ã®ãƒ¦ãƒ¼ã‚¶ã‚’dockerã‚°ãƒ«ãƒ¼ãƒ—ã«æ‰€å±ã•ã›ã‚‹ã“ã¨ã§ã€è‡ªèº«ã®ãƒ¦ãƒ¼ã‚¶ã§dockerã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
$ sudo usermod -aG docker $USER
```
ãã®å¾Œã€å†èµ·å‹•ã—ã¦å†åº¦ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸå¾Œã«**docker ps**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€æ¨©é™ã‚¨ãƒ©ãƒ¼ãŒãªãå®Ÿè¡Œçµæœã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚
```bash
$ sudo reboot

$ docker ps
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
```
ã“ã‚Œã§dockerã‚’ä½¿ç”¨ã§ãã‚‹ç’°å¢ƒã¯æ•´ã„ã¾ã—ãŸã€‚
æ¬¡ã«dockerã‚’å®Ÿéš›ã«å‹•ä½œã•ã›ã¦ã¿ã¦ã€å„ç¨®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸéš›ã«ä½•ãŒèµ·ã“ã‚‹ã®ã‹ã‚’èª¬æ˜ã—ã¦ã„ãã¾ã™ã€‚

# Dockerã®åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰
## ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã®ç®¡ç†
Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œæˆã™ã‚‹ãŸã‚ã«ã¯ã€ã‚³ãƒ³ãƒ†ãƒŠã®ã‚‚ã¨ã¨ãªã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒå¿…è¦ã§ã™ã€‚ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ãŒãƒ›ã‚¹ãƒˆã—ã¦ã‚ã‚‹ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã®Docker Hubã‹ã‚‰ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å–å¾—ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

### ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã®å–å¾—
**docker image pull**ã‚³ãƒãƒ³ãƒ‰ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã«å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
$ docker image pull nginx
Using default tag: latest
latest: Pulling from library/nginx
af302e5c37e9: Pull complete 
207b812743af: Pull complete 
841e383b441e: Pull complete 
0256c04a8d84: Pull complete 
38e992d287c5: Pull complete 
9e9aab598f58: Pull complete 
4de87b37f4ad: Pull complete 
Digest: sha256:0a399eb16751829e1af26fea27b20c3ec28d7ab1fb72182879dcae1cca21206a
Status: Downloaded newer image for nginx:latest
docker.io/library/nginx:latest
```

### ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã®ç¢ºèª
**docker image ls**ã‚³ãƒãƒ³ãƒ‰ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€ãƒ­ãƒ¼ã‚«ãƒ«ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
å…ˆã»ã©å–å¾—ã—ãŸnginxã‚¤ãƒ¡ãƒ¼ã‚¸ãŒç¢ºèªã§ãã¾ã™ã€‚
```bash
$ docker image ls -a
REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
nginx        latest    9bea9f2796e2   2 months ago   192MB
```

### ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã®è©³ç´°ç¢ºèª
**docker image inspect**ã‚³ãƒãƒ³ãƒ‰ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã®è©³ç´°æƒ…å ±ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
å…ˆã»ã©å–å¾—ã—ãŸnginxã‚¤ãƒ¡ãƒ¼ã‚¸ã®è©³ç´°æƒ…å ±ã‚’ç¢ºèªã§ãã¾ã™ã€‚
```bash
$ docker image inspect nginx
[
    {
        "Id": "sha256:9bea9f2796e236cb18c2b3ad561ff29f655d1001f9ec7247a0bc5e08d25652a1",
        "RepoTags": [
            "nginx:latest"
        ],
        "RepoDigests": [
            "nginx@sha256:0a399eb16751829e1af26fea27b20c3ec28d7ab1fb72182879dcae1cca21206a"
        ],
        "Parent": "",
        "Comment": "buildkit.dockerfile.v0",
        "Created": "2024-11-26T18:42:08Z",
        "DockerVersion": "",
        "Author": "",
        "Config": {
            "Hostname": "",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": false,
            "AttachStderr": false,
            "ExposedPorts": {
                "80/tcp": {}
            },
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
                "NGINX_VERSION=1.27.3",
                "NJS_VERSION=0.8.7",
                "NJS_RELEASE=1~bookworm",
                "PKG_RELEASE=1~bookworm",
                "DYNPKG_RELEASE=1~bookworm"
            ],
            "Cmd": [
                "nginx",
                "-g",
                "daemon off;"
            ],
            "Image": "",
            "Volumes": null,
            "WorkingDir": "",
            "Entrypoint": [
                "/docker-entrypoint.sh"
            ],
            "OnBuild": null,
            "Labels": {
                "maintainer": "NGINX Docker Maintainers <docker-maint@nginx.com>"
            },
            "StopSignal": "SIGQUIT"
        },
        "Architecture": "amd64",
        "Os": "linux",
        "Size": 191717838,
        "GraphDriver": {
            "Data": {
                "LowerDir": "/var/lib/docker/overlay2/c62106fa57349d94eba4e963b21800c22f8a52eab4590791913f1e7b8267b19d/diff:/var/lib/docker/overlay2/e5e14a96d8c8b642b1fc7d10fba4fc2cd655393d064110f1586df8da55df67e3/diff:/var/lib/docker/overlay2/1acda929ef130c2d441400007789f5a200c28f44cc7a329d69af92a5a34b4b26/diff:/var/lib/docker/overlay2/a97d6d46ca7cfdc6356a17cf13e50926900c1447e50a780a3aa7da5076d4a119/diff:/var/lib/docker/overlay2/f647c002739a739b7ab5a917f9dac86d0a92b578fa2148435279a686cb44cc9f/diff:/var/lib/docker/overlay2/f0bbaa46d35f96c04648c3200aa7bc376cd762a90f565725fcdd8fb51fb9c6cf/diff",
                "MergedDir": "/var/lib/docker/overlay2/9af8df103a8f7396f513e37bfa98ed46a2f77d1fcba4984756c94ed221f7da65/merged",
                "UpperDir": "/var/lib/docker/overlay2/9af8df103a8f7396f513e37bfa98ed46a2f77d1fcba4984756c94ed221f7da65/diff",
                "WorkDir": "/var/lib/docker/overlay2/9af8df103a8f7396f513e37bfa98ed46a2f77d1fcba4984756c94ed221f7da65/work"
            },
            "Name": "overlay2"
        },
        "RootFS": {
            "Type": "layers",
            "Layers": [
                "sha256:f5fe472da25334617e6e6467c7ebce41e0ae5580e5bd0ecbf0d573bacd560ecb",
                "sha256:88ebb510d2fb3ed50f4268455a38443074cad5c6957f6d2cd0126c899a159e6e",
                "sha256:9431321431991c4e64246007e04602160bca8984439ff96461fb992072dd49af",
                "sha256:32c977818204dc910140b3b7abcad06a6613dd1f511ce8f33626a364a3bb68b6",
                "sha256:541cf9cf006d6c9920e5897bf63a4dce0ae1a8388bc82bfa1abedc48b8eb1de9",
                "sha256:58045dd06e5b2c1220ab200c36b450ce3adbfd3fa0f8e3c2c17ffaf7f2906455",
                "sha256:b57b5eac2941c7c1f1f5bc2391123e553d0082eb8e1c6675101aab47a11b26ee"
            ]
        },
        "Metadata": {
            "LastTagTime": "0001-01-01T00:00:00Z"
        }
    }
]
```

### ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã®å±¥æ­´ã®ç¢ºèª
**docker image history**ã‚³ãƒãƒ³ãƒ‰ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã®å±¥æ­´æƒ…å ±ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
å…ˆã»ã©å–å¾—ã—ãŸnginxã‚¤ãƒ¡ãƒ¼ã‚¸ã®å±¥æ­´æƒ…å ±ã‚’ç¢ºèªã§ãã¾ã™ã€‚
```bash
$ docker image history nginx
IMAGE          CREATED        CREATED BY                                      SIZE      COMMENT
9bea9f2796e2   2 months ago   CMD ["nginx" "-g" "daemon off;"]                0B        buildkit.dockerfile.v0
<missing>      2 months ago   STOPSIGNAL SIGQUIT                              0B        buildkit.dockerfile.v0
<missing>      2 months ago   EXPOSE map[80/tcp:{}]                           0B        buildkit.dockerfile.v0
<missing>      2 months ago   ENTRYPOINT ["/docker-entrypoint.sh"]            0B        buildkit.dockerfile.v0
<missing>      2 months ago   COPY 30-tune-worker-processes.sh /docker-entâ€¦   4.62kB    buildkit.dockerfile.v0
<missing>      2 months ago   COPY 20-envsubst-on-templates.sh /docker-entâ€¦   3.02kB    buildkit.dockerfile.v0
<missing>      2 months ago   COPY 15-local-resolvers.envsh /docker-entrypâ€¦   389B      buildkit.dockerfile.v0
<missing>      2 months ago   COPY 10-listen-on-ipv6-by-default.sh /dockerâ€¦   2.12kB    buildkit.dockerfile.v0
<missing>      2 months ago   COPY docker-entrypoint.sh / # buildkit          1.62kB    buildkit.dockerfile.v0
<missing>      2 months ago   RUN /bin/sh -c set -x     && groupadd --systâ€¦   117MB     buildkit.dockerfile.v0
<missing>      2 months ago   ENV DYNPKG_RELEASE=1~bookworm                   0B        buildkit.dockerfile.v0
<missing>      2 months ago   ENV PKG_RELEASE=1~bookworm                      0B        buildkit.dockerfile.v0
<missing>      2 months ago   ENV NJS_RELEASE=1~bookworm                      0B        buildkit.dockerfile.v0
<missing>      2 months ago   ENV NJS_VERSION=0.8.7                           0B        buildkit.dockerfile.v0
<missing>      2 months ago   ENV NGINX_VERSION=1.27.3                        0B        buildkit.dockerfile.v0
<missing>      2 months ago   LABEL maintainer=NGINX Docker Maintainers <dâ€¦   0B        buildkit.dockerfile.v0
<missing>      2 months ago   # debian.sh --arch 'amd64' out/ 'bookworm' 'â€¦   74.8MB    debuerreotype 0.15
```

### ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã¸ã®ã‚¿ã‚°ä»˜ã‘
**docker image tag**ã‚³ãƒãƒ³ãƒ‰ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã¸ã‚¿ã‚°ã‚’ä»˜ä¸ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
å…ˆã»ã©å–å¾—ã—ãŸnginxã‚¤ãƒ¡ãƒ¼ã‚¸ã¸v1ã‚¿ã‚°ã‚’ä»˜ä¸ã—ã¦è¦‹ã¾ã™ã€‚
```bash
$ docker image tag nginx:latest nginx:v1
$ docker image ls
REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
nginx        latest    9bea9f2796e2   2 months ago   192MB
nginx        v1        9bea9f2796e2   2 months ago   192MB
```

### ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã®å‰Šé™¤
**docker image rm**ã‚³ãƒãƒ³ãƒ‰ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€ç‰¹å®šã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚„è¤‡æ•°ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å‰Šé™¤ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
$ docker image rm nginx
Untagged: nginx:latest
$ docker image ls
REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
nginx        v1        9bea9f2796e2   2 months ago   192MB
```

ã¾ãŸã€**docker image prune**ã‚³ãƒãƒ³ãƒ‰ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ã™ã¹ã¦å‰Šé™¤ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
$ docker image rm nginx
Untagged: nginx:latest
$ docker image ls
REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
nginx        v1        9bea9f2796e2   2 months ago   192MB

$ docker image prune -a
WARNING! This will remove all images without at least one container associated to them.
Are you sure you want to continue? [y/N] y
Deleted Images:
untagged: nginx:v1
untagged: nginx@sha256:0a399eb16751829e1af26fea27b20c3ec28d7ab1fb72182879dcae1cca21206a
deleted: sha256:9bea9f2796e236cb18c2b3ad561ff29f655d1001f9ec7247a0bc5e08d25652a1
deleted: sha256:ad858b4eee2d8f479065d1b8c650e13c815e75b2e4503c05a67cdc8880b0975a
deleted: sha256:a8d62a6e94dbe8920ecfafa3b3aff0ef70aa26ca929f90b110db998eec09bab5
deleted: sha256:8ad081ee0d46efdea0492cd0bb527c50a8891276fd408ec1269522ac9d6d5580
deleted: sha256:d9ff8651e34fffb11d2a29317ec8404dcd4481bfcc1883b495113365dba8a461
deleted: sha256:d351808aa3da5992f01a613745394c289e51a673d7809800322475b413e627e4
deleted: sha256:5ec183755d09a0a54d0f83e5a705f28f1606fe75660c13148fe125e4f12af39f
deleted: sha256:f5fe472da25334617e6e6467c7ebce41e0ae5580e5bd0ecbf0d573bacd560ecb

Total reclaimed space: 191.7MB
$ docker image ls
REPOSITORY   TAG       IMAGE ID   CREATED   SIZE
```


## ã‚³ãƒ³ãƒ†ãƒŠã®ç®¡ç†
**docker container**ã‚³ãƒãƒ³ãƒ‰ã¯ã€ã‚³ãƒ³ãƒ†ãƒŠã‚’ç®¡ç†ã™ã‚‹åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚

### ã‚³ãƒ³ãƒ†ãƒŠã®ä½œæˆ
ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œæˆã™ã‚‹ãŸã‚ã«ã¯ã€**docker container create**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
å–å¾—ã—ãŸnginxã‚¤ãƒ¡ãƒ¼ã‚¸ã‹ã‚‰nginxã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œæˆã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
```bash
$ docker container create -it --name nginx nginx
7b133740fabbd2225449d081ab045a2ce46b70e16502379fb4e8e59c3fa40b82
```

### ã‚³ãƒ³ãƒ†ãƒŠã®ç¢ºèª
ã‚³ãƒ³ãƒ†ãƒŠã‚’ä¸€è¦§è¡¨ç¤ºã—ã¦ç¢ºèªã™ã‚‹ãŸã‚ã«ã¯ã€**docker container ls**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€å®Ÿè¡Œä¸­ã®ã‚³ãƒ³ãƒ†ãƒŠã®ã¿è¡¨ç¤ºã™ã‚‹ã®ã§ã€ã™ã¹ã¦ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã«ã¯**-a**ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä»˜ä¸ã—ã¾ã™ã€‚
```bash
$ docker container ls -a
CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS    PORTS     NAMES
7b133740fabb   nginx     "/docker-entrypoint.â€¦"   27 seconds ago   Created             nginx
```

### ã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•
ä½œæˆã—ãŸã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã™ã‚‹ãŸã‚ã«ã¯ã€**docker container start**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
å…ˆã»ã©ä½œæˆã—ãŸnginxã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã—ã¾ã™ã€‚
```bash
$ docker container start nginx
nginx
$ docker container ls
CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS         PORTS     NAMES
7b133740fabb   nginx     "/docker-entrypoint.â€¦"   5 minutes ago   Up 5 seconds   80/tcp    nginx
```

### ã‚³ãƒ³ãƒ†ãƒŠã®ä¸€æ™‚åœæ­¢
ä½œæˆã—ãŸã‚³ãƒ³ãƒ†ãƒŠã®ä¸€æ™‚åœæ­¢ã‚’ã™ã‚‹ãŸã‚ã«ã¯ã€**docker container pause**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
å…ˆã»ã©ä½œæˆã—ãŸnginxã‚³ãƒ³ãƒ†ãƒŠã‚’ä¸€æ™‚åœæ­¢ã—ã¾ã™ã€‚STATUSãŒ**Paused**ã«ãªã£ã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚
```bash
$ docker container pause nginx
nginx
$ docker container ls
CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS                  PORTS     NAMES
7b133740fabb   nginx     "/docker-entrypoint.â€¦"   9 minutes ago   Up 3 minutes (Paused)   80/tcp    nginx
```

### ã‚³ãƒ³ãƒ†ãƒŠã®ä¸€æ™‚åœæ­¢ã®è§£é™¤
ä½œæˆã—ãŸã‚³ãƒ³ãƒ†ãƒŠã®ä¸€æ™‚åœæ­¢ã‚’è§£é™¤ã™ã‚‹ãŸã‚ã«ã¯ã€**docker container unpause**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
å…ˆã»ã©ä½œæˆã—ãŸnginxã‚³ãƒ³ãƒ†ãƒŠã®ä¸€æ™‚åœæ­¢ã‚’è§£é™¤ã—ã¾ã™ã€‚STATUSã®**Paused**ãŒãªããªã£ã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚

```bash
$ docker container unpause nginx
nginx
$ docker container ls
CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS         PORTS     NAMES
7b133740fabb   nginx     "/docker-entrypoint.â€¦"   15 minutes ago   Up 9 minutes   80/tcp    nginx
```

### ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ­ã‚°ç¢ºèª
èµ·å‹•ã—ã¦ã„ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ­ã‚°ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ã¯ã€**docker container logs**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
å…ˆã»ã©ä½œæˆã—ãŸnginxã‚³ãƒ³ãƒ†ãƒŠã®ãƒ­ã‚°ã‚’ç¢ºèªã—ã¾ã™ã€‚

```bash
$ docker container logs nginx
/docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration
/docker-entrypoint.sh: Looking for shell scripts in /docker-entrypoint.d/
/docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh
10-listen-on-ipv6-by-default.sh: info: Getting the checksum of /etc/nginx/conf.d/default.conf
10-listen-on-ipv6-by-default.sh: info: Enabled listen on IPv6 in /etc/nginx/conf.d/default.conf
/docker-entrypoint.sh: Sourcing /docker-entrypoint.d/15-local-resolvers.envsh
/docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh
/docker-entrypoint.sh: Launching /docker-entrypoint.d/30-tune-worker-processes.sh
/docker-entrypoint.sh: Configuration complete; ready for start up
2025/01/28 01:04:27 [notice] 1#1: using the "epoll" event method
2025/01/28 01:04:27 [notice] 1#1: nginx/1.27.3
2025/01/28 01:04:27 [notice] 1#1: built by gcc 12.2.0 (Debian 12.2.0-14) 
2025/01/28 01:04:27 [notice] 1#1: OS: Linux 5.14.0-503.21.1.el9_5.x86_64
2025/01/28 01:04:27 [notice] 1#1: getrlimit(RLIMIT_NOFILE): 1073741816:1073741816
2025/01/28 01:04:27 [notice] 1#1: start worker processes
2025/01/28 01:04:27 [notice] 1#1: start worker process 29
2025/01/28 01:04:27 [notice] 1#1: start worker process 30
```

### ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ­ã‚°ç¢ºèª
èµ·å‹•ã—ã¦ã„ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ­ã‚°ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ã¯ã€**docker container logs**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
å…ˆã»ã©ä½œæˆã—ãŸnginxã‚³ãƒ³ãƒ†ãƒŠã®ãƒ­ã‚°ã‚’ç¢ºèªã—ã¾ã™ã€‚

```bash
$ docker container logs nginx
/docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration
/docker-entrypoint.sh: Looking for shell scripts in /docker-entrypoint.d/
/docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh
10-listen-on-ipv6-by-default.sh: info: Getting the checksum of /etc/nginx/conf.d/default.conf
10-listen-on-ipv6-by-default.sh: info: Enabled listen on IPv6 in /etc/nginx/conf.d/default.conf
/docker-entrypoint.sh: Sourcing /docker-entrypoint.d/15-local-resolvers.envsh
/docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh
/docker-entrypoint.sh: Launching /docker-entrypoint.d/30-tune-worker-processes.sh
/docker-entrypoint.sh: Configuration complete; ready for start up
2025/01/28 01:04:27 [notice] 1#1: using the "epoll" event method
2025/01/28 01:04:27 [notice] 1#1: nginx/1.27.3
2025/01/28 01:04:27 [notice] 1#1: built by gcc 12.2.0 (Debian 12.2.0-14) 
2025/01/28 01:04:27 [notice] 1#1: OS: Linux 5.14.0-503.21.1.el9_5.x86_64
2025/01/28 01:04:27 [notice] 1#1: getrlimit(RLIMIT_NOFILE): 1073741816:1073741816
2025/01/28 01:04:27 [notice] 1#1: start worker processes
2025/01/28 01:04:27 [notice] 1#1: start worker process 29
2025/01/28 01:04:27 [notice] 1#1: start worker process 30
```

### ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ã®ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ
èµ·å‹•ã—ã¦ã„ã‚‹ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã¯ã€**docker container exec**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
å…ˆã»ã©ä½œæˆã—ãŸnginxã‚³ãƒ³ãƒ†ãƒŠå†…ã§**ls**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚
```bash
$ docker container exec nginx /bin/ls
bin
boot
dev
docker-entrypoint.d
docker-entrypoint.sh
etc
home
lib
lib64
media
mnt
opt
proc
root
run
sbin
srv
sys
tmp
usr
var
```

### ã‚³ãƒ³ãƒ†ãƒŠã®è©³ç´°æƒ…å ±ã®ç¢ºèª
èµ·å‹•ã—ã¦ã„ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã®è©³ç´°æƒ…å ±ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ã¯ã€**docker container inspect**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
å…ˆã»ã©ä½œæˆã—ãŸnginxã‚³ãƒ³ãƒ†ãƒŠã®è©³ç´°æƒ…å ±ã‚’ç¢ºèªã—ã¦ã¿ã¾ã™ã€‚
```bash
$ docker container inspect nginx
[
    {
        "Id": "7b133740fabbd2225449d081ab045a2ce46b70e16502379fb4e8e59c3fa40b82",
        "Created": "2025-01-28T00:58:55.588075253Z",
        "Path": "/docker-entrypoint.sh",
        "Args": [
            "nginx",
            "-g",
            "daemon off;"
        ],
        "State": {
            "Status": "running",
            "Running": true,
            "Paused": false,
            "Restarting": false,
            "OOMKilled": false,
            "Dead": false,
            "Pid": 8712,
            "ExitCode": 0,
            "Error": "",
            "StartedAt": "2025-01-28T01:04:26.813199789Z",
            "FinishedAt": "0001-01-01T00:00:00Z"
        },
        "Image": "sha256:9bea9f2796e236cb18c2b3ad561ff29f655d1001f9ec7247a0bc5e08d25652a1",
        "ResolvConfPath": "/var/lib/docker/containers/7b133740fabbd2225449d081ab045a2ce46b70e16502379fb4e8e59c3fa40b82/resolv.conf",
        "HostnamePath": "/var/lib/docker/containers/7b133740fabbd2225449d081ab045a2ce46b70e16502379fb4e8e59c3fa40b82/hostname",
        "HostsPath": "/var/lib/docker/containers/7b133740fabbd2225449d081ab045a2ce46b70e16502379fb4e8e59c3fa40b82/hosts",
        "LogPath": "/var/lib/docker/containers/7b133740fabbd2225449d081ab045a2ce46b70e16502379fb4e8e59c3fa40b82/7b133740fabbd2225449d081ab045a2ce46b70e16502379fb4e8e59c3fa40b82-json.log",
        "Name": "/nginx",
        "RestartCount": 0,
        "Driver": "overlay2",
        "Platform": "linux",
        "MountLabel": "",
        "ProcessLabel": "",
        "AppArmorProfile": "",
        "ExecIDs": null,
        "HostConfig": {
            "Binds": null,
            "ContainerIDFile": "",
            "LogConfig": {
                "Type": "json-file",
                "Config": {}
            },
            "NetworkMode": "bridge",
            "PortBindings": {},
            "RestartPolicy": {
                "Name": "no",
                "MaximumRetryCount": 0
            },
            "AutoRemove": false,
            "VolumeDriver": "",
            "VolumesFrom": null,
            "ConsoleSize": [
                39,
                112
            ],
            "CapAdd": null,
            "CapDrop": null,
            "CgroupnsMode": "private",
            "Dns": [],
            "DnsOptions": [],
            "DnsSearch": [],
            "ExtraHosts": null,
            "GroupAdd": null,
            "IpcMode": "private",
            "Cgroup": "",
            "Links": null,
            "OomScoreAdj": 0,
            "PidMode": "",
            "Privileged": false,
            "PublishAllPorts": false,
            "ReadonlyRootfs": false,
            "SecurityOpt": null,
            "UTSMode": "",
            "UsernsMode": "",
            "ShmSize": 67108864,
            "Runtime": "runc",
            "Isolation": "",
            "CpuShares": 0,
            "Memory": 0,
            "NanoCpus": 0,
            "CgroupParent": "",
            "BlkioWeight": 0,
            "BlkioWeightDevice": [],
            "BlkioDeviceReadBps": [],
            "BlkioDeviceWriteBps": [],
            "BlkioDeviceReadIOps": [],
            "BlkioDeviceWriteIOps": [],
            "CpuPeriod": 0,
            "CpuQuota": 0,
            "CpuRealtimePeriod": 0,
            "CpuRealtimeRuntime": 0,
            "CpusetCpus": "",
            "CpusetMems": "",
            "Devices": [],
            "DeviceCgroupRules": null,
            "DeviceRequests": null,
            "MemoryReservation": 0,
            "MemorySwap": 0,
            "MemorySwappiness": null,
            "OomKillDisable": null,
            "PidsLimit": null,
            "Ulimits": [],
            "CpuCount": 0,
            "CpuPercent": 0,
            "IOMaximumIOps": 0,
            "IOMaximumBandwidth": 0,
            "MaskedPaths": [
                "/proc/asound",
                "/proc/acpi",
                "/proc/kcore",
                "/proc/keys",
                "/proc/latency_stats",
                "/proc/timer_list",
                "/proc/timer_stats",
                "/proc/sched_debug",
                "/proc/scsi",
                "/sys/firmware",
                "/sys/devices/virtual/powercap"
            ],
            "ReadonlyPaths": [
                "/proc/bus",
                "/proc/fs",
                "/proc/irq",
                "/proc/sys",
                "/proc/sysrq-trigger"
            ]
        },
        "GraphDriver": {
            "Data": {
                "LowerDir": "/var/lib/docker/overlay2/29cb462ba0ae5b7700fe028003880be6fe7f9b1f56b65e5ae8dae65272608cbf-init/diff:/var/lib/docker/overlay2/a67c2c59f9fd17db2d1900a928231302fb5e1f2c7dfc8df59cbd14ca495771a9/diff:/var/lib/docker/overlay2/6d814e8d9628a52eeded47e8f7572b68e21de24b47c169490fbb859ddb196b56/diff:/var/lib/docker/overlay2/8a5b34ed2e7703191b20a96d5ec387488842c043559834bfbc3d381991b3dcaf/diff:/var/lib/docker/overlay2/41586b8716f54372dd795e8b6ac8caa9c3f01082e14aeed9a6c7330fa9474940/diff:/var/lib/docker/overlay2/76ddb28f01bdcae287544c511af70941e241bb4418a9372a639ed5818fc3208e/diff:/var/lib/docker/overlay2/baf066c30d879eefda95f4586b80278efa3396650e9c92dcc7f1242c07ae9a32/diff:/var/lib/docker/overlay2/c95ee7542ec60a44101d4fca283bf13e0de284e40853b29f21e2ad4a27b58d15/diff",
                "MergedDir": "/var/lib/docker/overlay2/29cb462ba0ae5b7700fe028003880be6fe7f9b1f56b65e5ae8dae65272608cbf/merged",
                "UpperDir": "/var/lib/docker/overlay2/29cb462ba0ae5b7700fe028003880be6fe7f9b1f56b65e5ae8dae65272608cbf/diff",
                "WorkDir": "/var/lib/docker/overlay2/29cb462ba0ae5b7700fe028003880be6fe7f9b1f56b65e5ae8dae65272608cbf/work"
            },
            "Name": "overlay2"
        },
        "Mounts": [],
        "Config": {
            "Hostname": "7b133740fabb",
            "Domainname": "",
            "User": "",
            "AttachStdin": true,
            "AttachStdout": true,
            "AttachStderr": true,
            "ExposedPorts": {
                "80/tcp": {}
            },
            "Tty": true,
            "OpenStdin": true,
            "StdinOnce": true,
            "Env": [
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
                "NGINX_VERSION=1.27.3",
                "NJS_VERSION=0.8.7",
                "NJS_RELEASE=1~bookworm",
                "PKG_RELEASE=1~bookworm",
                "DYNPKG_RELEASE=1~bookworm"
            ],
            "Cmd": [
                "nginx",
                "-g",
                "daemon off;"
            ],
            "Image": "nginx",
            "Volumes": null,
            "WorkingDir": "",
            "Entrypoint": [
                "/docker-entrypoint.sh"
            ],
            "OnBuild": null,
            "Labels": {
                "maintainer": "NGINX Docker Maintainers <docker-maint@nginx.com>"
            },
            "StopSignal": "SIGQUIT"
        },
        "NetworkSettings": {
            "Bridge": "",
            "SandboxID": "881af4be43ceb546e0b79294fa651314b1c7debab017c2647793ede3baea9ff1",
            "SandboxKey": "/var/run/docker/netns/881af4be43ce",
            "Ports": {
                "80/tcp": null
            },
            "HairpinMode": false,
            "LinkLocalIPv6Address": "",
            "LinkLocalIPv6PrefixLen": 0,
            "SecondaryIPAddresses": null,
            "SecondaryIPv6Addresses": null,
            "EndpointID": "83407366cd373fb662077b8a9af58469fcb0ed64c6e0284e74c29cc594511713",
            "Gateway": "172.17.0.1",
            "GlobalIPv6Address": "",
            "GlobalIPv6PrefixLen": 0,
            "IPAddress": "172.17.0.2",
            "IPPrefixLen": 16,
            "IPv6Gateway": "",
            "MacAddress": "02:42:ac:11:00:02",
            "Networks": {
                "bridge": {
                    "IPAMConfig": null,
                    "Links": null,
                    "Aliases": null,
                    "MacAddress": "02:42:ac:11:00:02",
                    "DriverOpts": null,
                    "NetworkID": "3d66a57a65ad26769b11bb624ddd8d89b50ee8c825b9c465b12a387dcdafefc6",
                    "EndpointID": "83407366cd373fb662077b8a9af58469fcb0ed64c6e0284e74c29cc594511713",
                    "Gateway": "172.17.0.1",
                    "IPAddress": "172.17.0.2",
                    "IPPrefixLen": 16,
                    "IPv6Gateway": "",
                    "GlobalIPv6Address": "",
                    "GlobalIPv6PrefixLen": 0,
                    "DNSNames": null
                }
            }
        }
    }
]
```

### ã‚³ãƒ³ãƒ†ãƒŠã®åœæ­¢
èµ·å‹•ã—ã¦ã„ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã‚’åœæ­¢ã™ã‚‹ãŸã‚ã«ã¯ã€**docker container stop**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
å…ˆã»ã©ä½œæˆã—ãŸnginxã‚³ãƒ³ãƒ†ãƒŠã®åœæ­¢ã—ã¦ã¿ã¾ã™ã€‚STATUSãŒ**Exited**ã«å¤‰æ›´ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

```bash
$ docker container stop nginx
nginx

$ docker container ls -a
CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS                     PORTS     NAMES
7b133740fabb   nginx     "/docker-entrypoint.â€¦"   40 minutes ago   Exited (0) 6 seconds ago             nginx
```

### ã‚³ãƒ³ãƒ†ãƒŠã®å‰Šé™¤
åœæ­¢ã—ãŸã‚³ãƒ³ãƒ†ãƒŠã‚‚å‰Šé™¤ã™ã‚‹ã¾ã§ã¯ã€ãƒ­ãƒ¼ã‚«ãƒ«ã«æ®‹ã£ã¦ã—ã¾ã„ã¾ã™ã€‚åœæ­¢æ¸ˆã¿ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’å‰Šé™¤ã™ã‚‹ã«ã¯**docker container rm**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
å…ˆã»ã©åœæ­¢ã—ãŸnginxã‚³ãƒ³ãƒ†ãƒŠã‚’å‰Šé™¤ã—ã¦ã¿ã¾ã™ã€‚

```bash
$ docker container rm nginx
nginx

$ docker container ls -a
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
```

### ã‚³ãƒ³ãƒ†ãƒŠã®å®Ÿè¡Œ
å…ˆã»ã©ã¾ã§ä»¥ä¸‹ã®æ‰‹é †ã§ã‚³ãƒ³ãƒ†ãƒŠã®èª¬æ˜ã—ã¦ã„ã¾ã—ãŸãŒã€
- ã‚¤ãƒ¡ãƒ¼ã‚¸ã®å–å¾—
- ã‚³ãƒ³ãƒ†ãƒŠã®ä½œæˆ
- ã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•
**docker container run**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ä¸Šè¨˜ã®æ‰‹é †ã‚’ä¸€ã¤ã®ã‚³ãƒãƒ³ãƒ‰ã§å®Ÿè¡Œã—ã¦ãã‚Œã¾ã™ã€‚
nginxã‚³ãƒ³ãƒ†ãƒŠã‚’**docker container run**ã‚³ãƒãƒ³ãƒ‰ã§èµ·å‹•ã¾ã§è¡Œã£ã¦ã„ãã¾ã—ã‚‡ã†ã€‚ã“ã®æ™‚ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã—ã¦ã„ã‚‹ã€Œ-iã€ã¯ã€ã‚³ãƒ³ãƒ†ãƒŠã¸æ¨™æº–å…¥åŠ›ã‚’è¡Œãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚ã€Œ-dã€ã¯ã€ãƒ‡ã‚¿ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•ï¼ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ãƒ—ãƒ­ã‚»ã‚¹ã§èµ·å‹•ã™ã‚‹ã‚ˆã†è¨­å®šã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚ã€Œ-tã€ã¯ã‚³ãƒ³ãƒ†ãƒŠã«ç–‘ä¼¼ttyã‚’å‰²ã‚Šå½“ã¦ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šæ¨™æº–å…¥åŠ›ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚ã¾ãŸã€ã€Œ-pã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚Šã€ãƒ›ã‚¹ãƒˆå´ã®ãƒãƒ¼ãƒˆã¨ã‚³ãƒ³ãƒ†ãƒŠã®ãƒãƒ¼ãƒˆã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã—ã¦ã„ã¾ã™ã€‚ä»Šå›ã¯ãƒ›ã‚¹ãƒˆå´ã®8080ãƒãƒ¼ãƒˆã‚’ã‚³ãƒ³ãƒ†ãƒŠã®ãƒãƒ¼ãƒˆ80ã¸ãƒãƒƒãƒ”ãƒ³ã‚°ã—ã¦ã„ã¾ã™ã€‚ã¤ã¾ã‚Šã€ãƒ›ã‚¹ãƒˆå´ã®ãƒãƒ¼ãƒˆ8080ã¸ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€ã‚³ãƒ³ãƒ†ãƒŠã®80ãƒãƒ¼ãƒˆã¸ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚Œã¾ã™ã€‚
èµ·å‹•ã—ãŸnginxã‚³ãƒ³ãƒ†ãƒŠã¸ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã¿ã¾ã™ã€‚ãƒ›ã‚¹ãƒˆå´ã®8080ãƒãƒ¼ãƒˆã¸curlã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã¿ã‚‹ã¨ã€nginxã®ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã®htmlãŒè¿”å´ã•ã‚ŒãŸã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚
```bash
$ docker container run -dit --name nginx -p 8080:80 nginx
2a42e67572a63ced9bc354ad2463a85bad8dec427d0598d0f777e207d1aedfdd

$ docker container ls
CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS         PORTS                                     NAMES
2a42e67572a6   nginx     "/docker-entrypoint.â€¦"   3 seconds ago   Up 3 seconds   0.0.0.0:8080->80/tcp, [::]:8080->80/tcp   nginx

$ curl localhost:8080
<!DOCTYPE html>
<html>
<head>
<title>Welcome to nginx!</title>
<style>
html { color-scheme: light dark; }
body { width: 35em; margin: 0 auto;
font-family: Tahoma, Verdana, Arial, sans-serif; }
</style>
</head>
<body>
<h1>Welcome to nginx!</h1>
<p>If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.</p>

<p>For online documentation and support please refer to
<a href="http://nginx.org/">nginx.org</a>.<br/>
Commercial support is available at
<a href="http://nginx.com/">nginx.com</a>.</p>

<p><em>Thank you for using nginx.</em></p>
</body>
</html>
```

# Dockerãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯
## Dockerãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®æ¦‚è¦
Dockerã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨ã€Dockerå°‚ç”¨ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç©ºé–“ (172.17.0.0/16) ã¨ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‰ãƒ©ã‚¤ãƒãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã«ä½œæˆã•ã‚Œã¾ã™ã€‚

```bash
$ ip address show | grep docker0
3: docker0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default 
    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0
15: vethb9fdb2a@if14: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue master docker0 state UP group default 

$ ip link show | grep docker0
3: docker0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default 
15: vethb9fdb2a@if14: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue master docker0 state UP mode DEFAULT group default 

$ ip route show | grep docker0
172.17.0.0/16 dev docker0 proto kernel scope link src 172.17.0.1
```

## Dockerãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‰ãƒ©ã‚¤ãƒ
Dockerã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‰ãƒ©ã‚¤ãƒã«ã¯ä»¥ä¸‹ã®6ç¨®é¡å­˜åœ¨ã—ã¾ã™ã€‚

| ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‰ãƒ©ã‚¤ãƒ | æ©Ÿèƒ½ |
| ---- | ---- |
| bridge | ã‚³ãƒ³ãƒ†ãƒŠä½œæˆæ™‚ã«ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ä½¿ç”¨ã•ã‚Œã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã€‚åŒã˜ãƒ›ã‚¹ãƒˆä¸Šã®ä»–ã®ã‚³ãƒ³ãƒ†ãƒŠã¨é€šä¿¡ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã§ã‚ˆãåˆ©ç”¨ã•ã‚Œã¾ã™ã€‚ |
| host | ã‚³ãƒ³ãƒ†ãƒŠã¨ Docker ãƒ›ã‚¹ãƒˆé–“ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ†é›¢ã‚’å‰Šé™¤ã—ã€ãƒ›ã‚¹ãƒˆã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ç›´æ¥ä½¿ç”¨ã—ã¾ã™ã€‚ |
| overlay | è¤‡æ•°ã® Docker ãƒ‡ãƒ¼ãƒ¢ãƒ³é–“ã‚’æ¥ç¶šã—ã€Docker Swarmã¨ã‚³ãƒ³ãƒ†ãƒŠãŒãƒãƒ¼ãƒ‰é–“ã§é€šä¿¡ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ |
| ipvlan |  IPv4ã¨IPv6ã®ä¸¡æ–¹ã®ã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®šã‚’å®Œå…¨ã«åˆ¶å¾¡ã§ãã¾ã™ã€‚ |
| macvlan | ã‚³ãƒ³ãƒ†ãƒŠã«MACã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‰²ã‚Šå½“ã¦ã¦ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®ç‰©ç†ãƒ‡ãƒã‚¤ã‚¹ã¨ã—ã¦è¡¨ç¤ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚Dockerãƒ‡ãƒ¼ãƒ¢ãƒ³ã¯ã€ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’MACã‚¢ãƒ‰ãƒ¬ã‚¹ã«ã‚ˆã£ã¦ã‚³ãƒ³ãƒ†ãƒŠã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã—ã¾ã™ã€‚ |
| none | ã‚³ãƒ³ãƒ†ãƒŠã‚’ãƒ›ã‚¹ãƒˆãŠã‚ˆã³ä»–ã®ã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰å®Œå…¨ã«åˆ†é›¢ã—ã¾ã™ã€‚ |

Dockerã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã«ã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ä»¥ä¸‹ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‰ãƒ©ã‚¤ãƒã‚’ä½œæˆã—ã¦ã„ã¾ã™ã€‚
```bash
$ docker network ls
NETWORK ID     NAME      DRIVER    SCOPE
3d66a57a65ad   bridge    bridge    local
645e777d3a0c   host      host      local
99a964c8093b   none      null      local
```

### bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯
bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯ã€åŒã˜ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚»ã‚°ãƒ¡ãƒ³ãƒˆé–“ã§ã®é€šä¿¡ã‚’å¯èƒ½ã«ã™ã‚‹ãƒªãƒ³ã‚¯å±¤ (L2å±¤)ã®ä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹ã§ã™ã€‚ãƒ–ãƒªãƒƒã‚¸ã¯ã€é€šå¸¸ã®ç‰©ç†ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ©Ÿå™¨ã«ç”¨ã„ã‚‰ã‚Œã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ãŒã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã§bridgeã®æ©Ÿèƒ½ã‚’æä¾›ã—ã¦ã„ã‚‹ã®ã§ä»®æƒ³ãƒ–ãƒªãƒƒã‚¸ã¨è¨€ã„ã¾ã™ã€‚bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯ã€åŒã˜bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã•ã‚ŒãŸã‚³ãƒ³ãƒ†ãƒŠåŒå£«ã¯é€šä¿¡ã§ãã‚‹ã‚ˆã†ã«ã—ã€æ¥ç¶šã•ã‚Œã¦ã„ãªã„ã‚³ãƒ³ãƒ†ãƒŠã¯é€šä¿¡ã§ããªã„ã‚ˆã†ã«è‡ªå‹•çš„ã«ãƒ›ã‚¹ãƒˆãƒã‚·ãƒ³ã«ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šã—ã¦ãã‚Œã¾ã™ã€‚

ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã™ã‚‹ã¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§**bridge**ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã«ä½œæˆã•ã‚Œã¾ã™ã€‚
alpine linuxã‚’300ç§’Sleepã™ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œæˆã—ã¦ã¿ã¾ã™ã€‚ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®æŒ‡å®šã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã—ã¦ã„ãªã„ã®ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®**bridge**ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒåˆ©ç”¨ã•ã‚Œã‚‹ã¯ãšã§ã™ã€‚
```bash
$ docker container run -d --name alpine-linux --rm alpine sleep 300

$ docker container ls
CONTAINER ID   IMAGE     COMMAND       CREATED          STATUS          PORTS     NAMES
6f58bcd0bcea   alpine    "sleep 300"   44 seconds ago   Up 44 seconds             alpine-linux
```

**docker network inspect**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‡ãƒã‚¤ã‚¹ã®è©³ç´°æƒ…å ±ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®è©³ç´°ã‚’ç¢ºèªã—ã¦ã¿ã¾ã™ã€‚**Containers**ã®ç®‡æ‰€ã‚’ç¢ºèªã™ã‚‹ã¨ã€ä½œæˆã—ãŸã‚³ãƒ³ãƒ†ãƒŠï¼ˆalpine-linuxï¼‰ãŒIPã‚¢ãƒ‰ãƒ¬ã‚¹ 172.17.0.3/16 ã¨ã—ã¦bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ‰€å±ã—ã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚
```bash
$ docker network inspect bridge
[
    {
        "Name": "bridge",
        "Id": "3d66a57a65ad26769b11bb624ddd8d89b50ee8c825b9c465b12a387dcdafefc6",
        "Created": "2025-01-24T23:45:41.480007785Z",
        "Scope": "local",
        "Driver": "bridge",
        "EnableIPv6": false,
        "IPAM": {
            "Driver": "default",
            "Options": null,
            "Config": [
                {
                    "Subnet": "172.17.0.0/16",
                    "Gateway": "172.17.0.1"
                }
            ]
        },
        "Internal": false,
        "Attachable": false,
        "Ingress": false,
        "ConfigFrom": {
            "Network": ""
        },
        "ConfigOnly": false,
        "Containers": {
            "6f58bcd0bceaf460afc31683d78e610624061a5275048c2543a8e0f869cfa026": {
                "Name": "alpine-linux",
                "EndpointID": "2ff8e5dadf8131d4956e95ac94de404cc5e12f7b3f0691dc0308573c5b21c157",
                "MacAddress": "02:42:ac:11:00:03",
                "IPv4Address": "172.17.0.3/16",
                "IPv6Address": ""
            }
        },
        "Options": {
            "com.docker.network.bridge.default_bridge": "true",
            "com.docker.network.bridge.enable_icc": "true",
            "com.docker.network.bridge.enable_ip_masquerade": "true",
            "com.docker.network.bridge.host_binding_ipv4": "0.0.0.0",
            "com.docker.network.bridge.name": "docker0",
            "com.docker.network.driver.mtu": "1500"
        },
        "Labels": {}
    }
]
```

ã“ã®æ™‚ã«ãƒ›ã‚¹ãƒˆå´ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯çŠ¶æ³ã‚’ç¢ºèªã™ã‚‹ã¨ã€ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•æ™‚ã«ã‚³ãƒ³ãƒ†ãƒŠã¨é€šä¿¡ã™ã‚‹ãŸã‚ã®ä»®æƒ³ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã™ã€‚
```bash
$ ip address show

19: vethc6a8080@if18: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue master docker0 state UP group default 
    link/ether b6:71:fd:a6:b5:9a brd ff:ff:ff:ff:ff:ff link-netnsid 0
    inet6 fe80::b471:fdff:fea6:b59a/64 scope link 
       valid_lft forever preferred_lft forever
```

ã“ã‚Œã¾ã§ã‚’å›³ã§è¡¨ã™ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªçŠ¶æ…‹ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚
![bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯01](/images/docker-20250125/bridge-network01.drawio.png)


æ¬¡ã«ã€è¤‡æ•°ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œæˆã—ãŸã¨ãã«ã¯ã©ã†ãªã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿ
æ–°ã—ã**alpine-linux01**ã¨**alpine-linux02**ã‚’ä½œæˆã—ã¦bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®çŠ¶æ…‹ã‚’ç¢ºèªã—ã¦ã¿ã¾ã™ã€‚

```bash
$ docker container run -d --name alpine-linux01 --rm alpine sleep 300
929b7849fb1206108c6b32cbe9fa4f28b243a68f64fd9402396bcdbbe4fefb51

$ docker container run -d --name alpine-linux02 --rm alpine sleep 300
a83bab22d215f900b2e6c5271d95d3408640d0ab7531994441eaf2fb975319b2

$ docker container ls
CONTAINER ID   IMAGE     COMMAND       CREATED         STATUS         PORTS     NAMES
a83bab22d215   alpine    "sleep 300"   5 seconds ago   Up 4 seconds             alpine-linux02
929b7849fb12   alpine    "sleep 300"   8 seconds ago   Up 8 seconds             alpine-linux01

$ docker network inspect bridge
[
    {
        "Name": "bridge",
        "Id": "3d66a57a65ad26769b11bb624ddd8d89b50ee8c825b9c465b12a387dcdafefc6",
        "Created": "2025-01-24T23:45:41.480007785Z",
        "Scope": "local",
        "Driver": "bridge",
        "EnableIPv6": false,
        "IPAM": {
            "Driver": "default",
            "Options": null,
            "Config": [
                {
                    "Subnet": "172.17.0.0/16",
                    "Gateway": "172.17.0.1"
                }
            ]
        },
        "Internal": false,
        "Attachable": false,
        "Ingress": false,
        "ConfigFrom": {
            "Network": ""
        },
        "ConfigOnly": false,
        "Containers": {
            "929b7849fb1206108c6b32cbe9fa4f28b243a68f64fd9402396bcdbbe4fefb51": {
                "Name": "alpine-linux01",
                "EndpointID": "94532654b4f11232941bcb8521a45ef41c1251790ac79ea55d2c9f326a1cb4f3",
                "MacAddress": "02:42:ac:11:00:02",
                "IPv4Address": "172.17.0.2/16",
                "IPv6Address": ""
            },
            "a83bab22d215f900b2e6c5271d95d3408640d0ab7531994441eaf2fb975319b2": {
                "Name": "alpine-linux02",
                "EndpointID": "cccb8c9a7a86d0bd5dcd2cf3664fb4f35460784ebd066546f679b22aca40d445",
                "MacAddress": "02:42:ac:11:00:03",
                "IPv4Address": "172.17.0.3/16",
                "IPv6Address": ""
            }
        },
        "Options": {
            "com.docker.network.bridge.default_bridge": "true",
            "com.docker.network.bridge.enable_icc": "true",
            "com.docker.network.bridge.enable_ip_masquerade": "true",
            "com.docker.network.bridge.host_binding_ipv4": "0.0.0.0",
            "com.docker.network.bridge.name": "docker0",
            "com.docker.network.driver.mtu": "1500"
        },
        "Labels": {}
    }
]
```
äºŒã¤ã®ã‚³ãƒ³ãƒ†ãƒŠã¯ã€bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã•ã‚Œã€alpine-linux01ã«ã¯172.17.0.2/16ã€alpine-linux02ã«ã¯172.17.0.3/16ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã—ãŸã€‚
ã“ã‚Œã¾ã§ã‚’å›³ã§è¡¨ã™ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªçŠ¶æ…‹ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚
![bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯02](/images/docker-20250125/bridge-network02.drawio.png)

åŒã˜bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã•ã‚Œã¦ã„ã‚‹ã‚³ãƒ³ãƒ†ãƒŠåŒå£«ã¯ç›¸äº’ã«é€šä¿¡ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚ãã‚Œãã‚Œã®ã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒŠã¸pingã‚’å®Ÿè¡Œã™ã‚‹ã¨æ­£å¸¸ã«é€šä¿¡ã§ãã¾ã—ãŸã€‚

```bash
$ docker container exec alpine-linux01 ping -c 3 172.17.0.3
PING 172.17.0.3 (172.17.0.3): 56 data bytes
64 bytes from 172.17.0.3: seq=0 ttl=64 time=0.186 ms
64 bytes from 172.17.0.3: seq=1 ttl=64 time=0.077 ms
64 bytes from 172.17.0.3: seq=2 ttl=64 time=0.125 ms

--- 172.17.0.3 ping statistics ---
3 packets transmitted, 3 packets received, 0% packet loss
round-trip min/avg/max = 0.077/0.129/0.186 ms

$ docker container exec alpine-linux02 ping -c 3 172.17.0.2
PING 172.17.0.2 (172.17.0.2): 56 data bytes
64 bytes from 172.17.0.2: seq=0 ttl=64 time=0.074 ms
64 bytes from 172.17.0.2: seq=1 ttl=64 time=0.124 ms
64 bytes from 172.17.0.2: seq=2 ttl=64 time=0.097 ms

--- 172.17.0.2 ping statistics ---
3 packets transmitted, 3 packets received, 0% packet loss
round-trip min/avg/max = 0.074/0.098/0.124 ms
```

bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯ã€ãƒ¦ãƒ¼ã‚¶è‡ªèº«ã§å®šç¾©ã—ã¦ä½œæˆã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ã§å®šç¾©ã—ã¦ä½œæˆã—ãŸbridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§ã¯ã€ã‚³ãƒ³ãƒ†ãƒŠé–“ã®é€šä¿¡ã«**DNSã«ã‚ˆã‚‹åå‰è§£æ±ºæ©Ÿèƒ½**ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ãã¾ã™ã€‚DNSã«ã‚ˆã‚‹åå‰è§£æ±ºæ©Ÿèƒ½ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã‚³ãƒ³ãƒ†ãƒŠé–“ã®é€šä¿¡ã‚’è¡Œã†éš›ã«ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç›´æ¥æŒ‡å®šã™ã‚‹ã“ã¨ãªãã€ã‚³ãƒ³ãƒ†ãƒŠåã§é€šä¿¡ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚
ã¾ãŸã€ç•°ãªã‚‹bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«å±ã—ã¦ã„ã‚‹ã‚³ãƒ³ãƒ†ãƒŠé–“ã§ã¯ã€äº’ã„ã«é€šä¿¡ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚ãã®ãŸã‚ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’åˆ†é›¢ã™ã‚‹ã“ã¨ã§ä¸è¦ãªã‚³ãƒ³ãƒ†ãƒŠé–“ã®é€šä¿¡ã‚’é˜²ãã“ã¨ãŒã§ãåˆ†é›¢æ€§ãŒå‘ä¸Šã—ã¾ã™ã€‚ã‚³ãƒ³ãƒ†ãƒŠè‡ªèº«ã¯ã‚³ãƒãƒ³ãƒ‰ä¸€ã¤ã§ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šãƒ»åˆ‡æ–­ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

å®Ÿéš›ã«ã€bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ä½œæˆã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ãƒ¦ãƒ¼ã‚¶å®šç¾©ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ä½œæˆã™ã‚‹ãŸã‚ã«ã¯ã€**docker network create**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
```bash
$ docker network create my-net --driver bridge
300b094e6d5d37d7d59719045a4e3c1ae7bdd8cd7b44097c8ef36e07cf84e051
$ docker network ls
NETWORK ID     NAME      DRIVER    SCOPE
3d66a57a65ad   bridge    bridge    local
645e777d3a0c   host      host      local
300b094e6d5d   my-net    bridge    local
99a964c8093b   none      null      local
```

ãƒ¦ãƒ¼ã‚¶å®šç¾©ã®bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼ˆmy-netï¼‰ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ããŸã®ã§ã€è©³ç´°æƒ…å ±ã‚’ç¢ºèªã—ã¦ã„ãã¾ã™ã€‚**docker network inspect**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®è©³ç´°æƒ…å ±ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
$ docker network inspect my-net
[
    {
        "Name": "my-net",
        "Id": "300b094e6d5d37d7d59719045a4e3c1ae7bdd8cd7b44097c8ef36e07cf84e051",
        "Created": "2025-01-30T20:21:36.397509121Z",
        "Scope": "local",
        "Driver": "bridge",
        "EnableIPv6": false,
        "IPAM": {
            "Driver": "default",
            "Options": {},
            "Config": [
                {
                    "Subnet": "172.18.0.0/16",
                    "Gateway": "172.18.0.1"
                }
            ]
        },
        "Internal": false,
        "Attachable": false,
        "Ingress": false,
        "ConfigFrom": {
            "Network": ""
        },
        "ConfigOnly": false,
        "Containers": {},
        "Options": {},
        "Labels": {}
    }
]
```

ä½œæˆã—ãŸãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã«ã‚³ãƒ³ãƒ†ãƒŠã‚’ç«‹ã¦ã¦ã€ã‚³ãƒ³ãƒ†ãƒŠé–“ã®é€šä¿¡ã«**DNSã«ã‚ˆã‚‹åå‰è§£æ±ºæ©Ÿèƒ½**ã‚’åˆ©ç”¨ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
```bash
$ docker container run -d --name alpine-linux01 --network my-net --rm alpine sleep 300 
2952b84733460370e53fd0b803145b1699bc6e23637b3d6d867b52f11e9ee8b7
$ docker container run -d --name alpine-linux02 --network my-net --rm alpine sleep 300 
759a82366abe67c17a6ff2d48501e0782e858ea0237f2f7e243df2169e201b49

$ docker container exec alpine-linux01 ping -c 3 alpine-linux02
PING alpine-linux02 (172.18.0.3): 56 data bytes
64 bytes from 172.18.0.3: seq=0 ttl=64 time=0.071 ms
64 bytes from 172.18.0.3: seq=1 ttl=64 time=0.122 ms
64 bytes from 172.18.0.3: seq=2 ttl=64 time=0.115 ms

--- alpine-linux02 ping statistics ---
3 packets transmitted, 3 packets received, 0% packet loss
round-trip min/avg/max = 0.071/0.102/0.122 ms

$ docker container exec alpine-linux02 ping -c 3 alpine-linux01
PING alpine-linux01 (172.18.0.2): 56 data bytes
64 bytes from 172.18.0.2: seq=0 ttl=64 time=0.139 ms
64 bytes from 172.18.0.2: seq=1 ttl=64 time=0.088 ms
64 bytes from 172.18.0.2: seq=2 ttl=64 time=0.231 ms

--- alpine-linux01 ping statistics ---
3 packets transmitted, 3 packets received, 0% packet loss
round-trip min/avg/max = 0.088/0.152/0.231 ms
```
DNSã«ã‚ˆã‚‹åå‰è§£æ±ºæ©Ÿèƒ½ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã‚³ãƒ³ãƒ†ãƒŠé–“ã®é€šä¿¡ã‚’è¡Œã†éš›ã«ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç›´æ¥æŒ‡å®šã™ã‚‹ã“ã¨ãªãã€ã‚³ãƒ³ãƒ†ãƒŠåã‚’åˆ©ç”¨ã—é€šä¿¡ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã—ãŸã€‚

![bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯03](/images/docker-20250125/bridge-network03.drawio.png)

ãã‚Œã§ã¯ã€ä½œæˆã—ãŸãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã®ã‚³ãƒ³ãƒ†ãƒŠã¨ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã®ã‚³ãƒ³ãƒ†ãƒŠé–“ã®é€šä¿¡ã¯ã©ã†ãªã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿ
ä½œæˆã—ãŸãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã®ã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã®ã‚³ãƒ³ãƒ†ãƒŠã¸ã®é€šä¿¡ã¯ã€**ping: bad address 'alpine-linux03'**ã¨è¡¨ç¤ºã•ã‚Œã€**DNSã«ã‚ˆã‚‹åå‰è§£æ±ºæ©Ÿèƒ½**ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚ã¾ãŸã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç›´æŒ‡å®šã—ã¦ã®é€šä¿¡ã‚‚ã§ããªã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ç•°ãªã‚‹bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«å±ã—ã¦ã„ã‚‹ã‚³ãƒ³ãƒ†ãƒŠé–“ã§ã¯ã€äº’ã„ã«é€šä¿¡ã™ã‚‹ã“ã¨ã¯ã§ããªã„ã“ã¨ãŒç¢ºèªã§ãã¾ã—ãŸã€‚

```bash
$ docker container run -d --name alpine-linux03 --rm alpine sleep 300 
52b3da9559a35953c829742cd452142e66fc8abed6f8ffb2242d055b7bd74695

$ docker container exec alpine-linux02 ping -c 3 alpine-linux03
ping: bad address 'alpine-linux03'

$ docker container exec alpine-linux01 ping -c 3 172.17.0.2
PING 172.17.0.2 (172.17.0.2): 56 data bytes

--- 172.17.0.2 ping statistics ---
3 packets transmitted, 0 packets received, 100% packet loss
```
![bridgeãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯04](/images/docker-20250125/bridge-network04.drawio.png)

è‡ªèº«ã§ä½œæˆã—ãŸãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’å‰Šé™¤ã—ãŸã„å ´åˆã¯ã€**docker network rm**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
```bash
$ docker network rm my-net
my-net

$ docker network ls
NETWORK ID     NAME      DRIVER    SCOPE
3d66a57a65ad   bridge    bridge    local
645e777d3a0c   host      host      local
99a964c8093b   none      null      local
```

### hostãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯
hostãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯ã€dockerãƒ›ã‚¹ãƒˆå´ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚ã‚³ãƒ³ãƒ†ãƒŠã‚’hostãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã—ãŸå ´åˆã€dockerãƒ›ã‚¹ãƒˆå´ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨åŒã˜è¨­å®šã«ãªã‚Šã¾ã™ã€‚ã‚³ãƒ³ãƒ†ãƒŠè‡ªèº«ã«ã¯IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¯ä»˜ä¸ã•ã‚Œãšã€ã¾ãŸãƒãƒ¼ãƒˆã®å‰²å½“ã¦ã‚‚ç„¡åŠ¹ã«ãªã‚Šã¾ã™ã€‚nginxã‚³ãƒ³ãƒ†ãƒŠã‚’hostãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã™ã‚‹ã“ã¨ã§ã€dockerãƒ›ã‚¹ãƒˆã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã€ãƒãƒ¼ãƒˆ80ã§nginxãŒèµ·å‹•ã—ã¾ã™ã€‚ãã®ãŸã‚ã€curlã‚³ãƒãƒ³ãƒ‰ã‚’**localhost:80**ã«å®Ÿè¡Œã™ã‚‹ã“ã¨ã§nginxã®htmlãŒè¿”ã£ã¦ãã¾ã™ã€‚

![hostãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯](/images/docker-20250125/host-network.drawio.png)

```bash
$ docker container run -d --name nginx --network host nginx 
95a8a17597590d09e4f62e1e43e54dcdaec54b9241469bb44617454babeb6402

$ docker container ls
CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS     NAMES
95a8a1759759   nginx     "/docker-entrypoint.â€¦"   4 seconds ago    Up 3 seconds              nginx

$ curl localhost:80
<!DOCTYPE html>
<html>
<head>
<title>Welcome to nginx!</title>
<style>
html { color-scheme: light dark; }
body { width: 35em; margin: 0 auto;
font-family: Tahoma, Verdana, Arial, sans-serif; }
</style>
</head>
<body>
<h1>Welcome to nginx!</h1>
<p>If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.</p>

<p>For online documentation and support please refer to
<a href="http://nginx.org/">nginx.org</a>.<br/>
Commercial support is available at
<a href="http://nginx.com/">nginx.com</a>.</p>

<p><em>Thank you for using nginx.</em></p>
</body>
</html>
```

### noneãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯
noneãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯ã€ã‚³ãƒ³ãƒ†ãƒŠã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ©Ÿèƒ½ã‚’ç„¡åŠ¹åŒ–ã—ã€å®Œå…¨ã«ç‹¬ç«‹ã—ãŸçŠ¶æ…‹ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚³ãƒ³ãƒ†ãƒŠè‡ªèº«ã«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¯å‰²ã‚ŠæŒ¯ã‚‰ã‚Œãšã€ã‚³ãƒ³ãƒ†ãƒŠé–“ã®é€šä¿¡ã‚„ã€å¤–éƒ¨ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«é€šä¿¡ã‚’ã—ãŸã‚Šã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚
noneãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã—ã¦ã„ã‚‹ã‚³ãƒ³ãƒ†ãƒŠå†…ã§**å„ç¨®ipã‚³ãƒãƒ³ãƒ‰**ã‚’å®Ÿè¡Œã™ã‚‹ã¨ãƒ«ãƒ¼ãƒ—ãƒãƒƒã‚¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã—ã‹å­˜åœ¨ã›ãšã€ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã¯å­˜åœ¨ã—ãªã„ã§ã™ã€‚ã¾ãŸã€IPã‚¢ãƒ‰ãƒ¬ã‚¹8.8.8.8ã¸pingã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã‚‚**Network unreachable**ã¨è¡¨ç¤ºã•ã‚Œéš”é›¢ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

![noneãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯](/images/docker-20250125/none-network.drawio.png)

```bash
$ docker container run -d --name alpine-linux01 --network none --rm alpine sleep 300 
e9b82e397e550835c369013cbcc9ab1a046e670f908aeecef54f7751ec53d0f8

$ docker network inspect none
[
    {
        "Name": "none",
        "Id": "99a964c8093b7b0b10eb5d43f643f6f5831456bb18f01a9d1aee2230eb5a89cc",
        "Created": "2025-01-24T23:17:48.861986575Z",
        "Scope": "local",
        "Driver": "null",
        "EnableIPv6": false,
        "IPAM": {
            "Driver": "default",
            "Options": null,
            "Config": null
        },
        "Internal": false,
        "Attachable": false,
        "Ingress": false,
        "ConfigFrom": {
            "Network": ""
        },
        "ConfigOnly": false,
        "Containers": {
            "e9b82e397e550835c369013cbcc9ab1a046e670f908aeecef54f7751ec53d0f8": {
                "Name": "alpine-linux01",
                "EndpointID": "139b7879587a0481cde520ead77e3a3b083171c8ead5ce902ceaeecac34dce7d",
                "MacAddress": "",
                "IPv4Address": "",
                "IPv6Address": ""
            }
        },
        "Options": {},
        "Labels": {}
    }
]
$ docker container exec alpine-linux01 ip link show
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00

$ docker container exec alpine-linux01 ip address show
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever

$ docker container exec alpine-linux01 ip route show

$ docker container exec alpine-linux01 ping -c 3 8.8.8.8
PING 8.8.8.8 (8.8.8.8): 56 data bytes
ping: sendto: Network unreachable
```

# Docker Storage
## Dockerã§ã®ãƒ‡ãƒ¼ã‚¿ç®¡ç†æ–¹æ³•
Dockerã‚³ãƒ³ãƒ†ãƒŠå†…ã§ä½œæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ç­‰ã®ãƒ‡ãƒ¼ã‚¿ã¯ã€ã‚³ãƒ³ãƒ†ãƒŠãŒå‰Šé™¤ã•ã‚Œã‚‹ã¨ä¸€ç·’ã«æ¶ˆãˆã¦ã—ã¾ã„ã¾ã™ã€‚ã“ã‚Œã¯Linuxã®åå‰ç©ºé–“ã¨ã„ã†æ©Ÿèƒ½ã«ã‚ˆã‚Šã‚³ãƒ³ãƒ†ãƒŠã®ãƒ—ãƒ­ã‚»ã‚¹ã”ã¨ã«ç‹¬ç«‹ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’æŒã¤ãŸã‚ã€ã‚³ãƒ³ãƒ†ãƒŠï¼ˆãƒ—ãƒ­ã‚»ã‚¹ï¼‰ãŒå‰Šé™¤ã•ã‚Œã€æ–°ãŸã«ã‚³ãƒ³ãƒ†ãƒŠï¼ˆãƒ—ãƒ­ã‚»ã‚¹ï¼‰ãŒä½œæˆã•ã‚Œã‚‹ã¨å…¨ãåˆ¥ã®åå‰ç©ºé–“ãŒä½œæˆã•ã‚Œã€ãã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ãƒ•ã‚¡ã‚¤ãƒ«ã®å¼•ç¶™ãã¯ã§ããªã„ã§ã™ã€‚
ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œæˆã—ã€ã‚³ãƒ³ãƒ†ãƒŠå†…ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ãŸã‚ã¨ã€ã‚³ãƒ³ãƒ†ãƒŠå†…ã‹ã‚‰æŠœã‘ã¾ã™ã€‚
```bash
$ docker container run -dit --name alpine-linux alpine
20f9fdf613b700adb2424d157c5b04dcd24a25daea42e1f015af6a3691cb262d

$ docker container ls
CONTAINER ID   IMAGE     COMMAND     CREATED         STATUS         PORTS     NAMES
20f9fdf613b7   alpine    "/bin/sh"   2 seconds ago   Up 2 seconds             alpine-linux

$ docker container exec -it alpine-linux /bin/sh
/ # touch ~/text.txt
/ # ls ~/text.txt
/root/text.txt
/ # exit
```
ã‚³ãƒ³ãƒ†ãƒŠã‚’åœæ­¢ã—ã€å‰Šé™¤ã—ã¾ã™ã€‚

```bash
$ docker container stop alpine-linux
alpine-linux

$ docker container rm alpine-linux
alpine-linux
```

å†åº¦ã€åŒã˜ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œæˆã—ã¦ã‚³ãƒ³ãƒ†ãƒŠå†…ã«å…¥ã£ã¦å…ˆã»ã©ä½œæˆã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€**/root/text.txt: No such file or directory**ã¨è¡¨ç¤ºã•ã‚Œãƒ•ã‚¡ã‚¤ãƒ«ãŒå¼•ãç¶™ãŒã‚Œã¦ã„ãªã„ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚
```bash
$ docker container run -dit --name alpine-linux alpine
770665894aaf569c4d06a84312888321db59dfdaa24cf6e4eb643416e5eecfbe

$ docker container ls
CONTAINER ID   IMAGE     COMMAND     CREATED         STATUS         PORTS     NAMES
770665894aaf   alpine    "/bin/sh"   7 seconds ago   Up 6 seconds             alpine-linux

$ docker container exec -it alpine-linux /bin/sh
/ # ls ~/text.txt
ls: /root/text.txt: No such file or directory
/ # exit
```

ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ä½œæˆã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ãƒ›ã‚¹ãƒˆä¸Šã«ä¿å­˜ã—ãŸã„ã€åˆ¥ã®ã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰ã‚‚å…±æœ‰ã—ã¦ä½¿ç”¨ã—ãŸã„ã¨ã„ã£ãŸãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šæ€§ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã®æŠ€è¡“ã¨ã—ã¦Dockerã¯ã„ãã¤ã‹ã®ãƒã‚¦ãƒ³ãƒˆæ©Ÿèƒ½ã‚’æä¾›ã—ã¦ã„ã‚‹ã€‚

## ãƒã‚¦ãƒ³ãƒˆ
### volume
Docker ã«ã‚ˆã£ã¦ç®¡ç†ã•ã‚Œã¦ã„ã‚‹ãƒ›ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ä¸Šã®ä¸€éƒ¨ã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿ç®¡ã—ã¾ã™ã€‚Linuxãƒ›ã‚¹ãƒˆä¸Šã§ã¯ **/var/lib/docker/volumes**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚**docker volume ls**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€volumeã®ä¸€è¦§ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã¾ãŸã€**docker volume create**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€æ–°è¦ã®ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã€ãƒœãƒªãƒ¥ãƒ¼ãƒ ã®è©³ç´°æƒ…å ±ã‚’ç¢ºèªã—ãŸã„å ´åˆã¯**docker volume inspect**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```bash
$ docker volume ls
DRIVER    VOLUME NAME

$ docker volume create vm1
vm1

$ docker volume ls
DRIVER    VOLUME NAME
local     vm1

$ docker volume inspect vm1
[
    {
        "CreatedAt": "2025-01-31T21:07:16Z",
        "Driver": "local",
        "Labels": null,
        "Mountpoint": "/var/lib/docker/volumes/vm1/_data",
        "Name": "vm1",
        "Options": null,
        "Scope": "local"
    }
]
```

ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’ä½œæˆã™ã‚‹ã¨ã€ãƒ›ã‚¹ãƒˆå´ã®**/var/lib/docker/volumes**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã«æ–°ãŸã«**vm1**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒä½œæˆã•ã‚Œã€ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨ã‚³ãƒ³ãƒ†ãƒŠå†…ãŒãƒã‚¦ãƒ³ãƒˆã•ã‚Œã¾ã™ã€‚
```bash
$ sudo ls -ltr /var/lib/docker/volumes/vm1/
total 0
drwxr-xr-x. 2 root root 6 Jan 31 21:07 _data
```

ãƒœãƒªãƒ¥ãƒ¼ãƒ ãŒä½œæˆã•ã‚ŒãŸã®ã§ã€ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œæˆã—ã€ãƒœãƒªãƒ¥ãƒ¼ãƒ ãƒã‚¦ãƒ³ãƒˆã—ã¦ã„ãã¾ã™ã€‚ã‚³ãƒ³ãƒ†ãƒŠã«ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’ãƒã‚¦ãƒ³ãƒˆã•ã›ã‚‹ãŸã‚ã«ã¯ã€**docker container run**ã‚³ãƒãƒ³ãƒ‰ã«ã€Œ--mountã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä»˜ä¸ã—ã¾ã™ã€‚ã€Œ--mountã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ã¯ã€ã„ãã¤ã‹å¼•æ•°ã‚’ã¨ã‚Šã¾ã™ã€‚**type**ã«ã¯ã€ãƒã‚¦ãƒ³ãƒˆã®ç¨®é¡ã‚’æŒ‡å®šã—ã¾ã™ã€‚ä»Šå›ã¯ãƒœãƒªãƒ¥ãƒ¼ãƒ ãƒã‚¦ãƒ³ãƒˆã®ãŸã‚ã€**type=volume**ã‚’æŒ‡å®šã—ã¾ã™ã€‚**src**ã«ã¯ã€ä½œæˆã—ãŸãƒœãƒªãƒ¥ãƒ¼ãƒ åã‚’æŒ‡å®šã—ã¾ã™ã€‚ä»Šå›ã¯**src=vm1**ã‚’æŒ‡å®šã—ã¾ã™ã€‚**target**ã«ã¯ã€ãƒã‚¦ãƒ³ãƒˆã«åˆ©ç”¨ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’æŒ‡å®šã—ã¾ã™ã€‚ä»Šå›ã¯**target=/home**ã¨ã—ã¾ã—ãŸã€‚
```bash
$ docker container run -dit --name alpine-linux1 --mount type=volume,src=vm1,target=/home alpine
9d08bc94b020ffb145fb958249c6206e6a271cce095501db47534175dfe68ef5
```

ãƒœãƒªãƒ¥ãƒ¼ãƒ ãƒã‚¦ãƒ³ãƒˆã‚’ã—ã¦ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã—ãŸã‚ã¨ã€ã‚³ãƒ³ãƒ†ãƒŠå†…ã«å…¥ã‚Šã€ãƒã‚¦ãƒ³ãƒˆã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã§**test.txt**ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰æŠœã‘ã¾ã™ã€‚ãã®å¾Œã€ã‚³ãƒ³ãƒ†ãƒŠã‚’åœæ­¢ãƒ»å‰Šé™¤ã—ãŸå¾Œã€å†åº¦ãƒœãƒªãƒ¥ãƒ¼ãƒ ãƒã‚¦ãƒ³ãƒˆã‚’ã—ã¦ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã—å…ˆã»ã©ä½œæˆã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã™ã‚‹ã¨ç„¡äº‹ã«**test.txt**ãƒ•ã‚¡ã‚¤ãƒ«ãŒç¢ºèªã§ãã¾ã—ãŸã€‚
```bash
$ docker container exec -it alpine-linux1 /bin/sh
/ # cd /home
/home # touch test.txt
/home # ls test.txt
test.txt
/home # exit

$ docker container stop alpine-linux1
alpine-linux1

$ docker container rm alpine-linux1
alpine-linux1

$ docker container run -dit --name alpine-linux1 --mount type=volume,src=vm1,target=/home alpine
f4647b31d7eead2d4a24dc9306dec81989446816814b397edb4dcac5d23482b2

$ cd /home

$ docker container exec -it alpine-linux1 /bin/sh
/ # cd /home
/home # ls test.txt 
test.txt
```

Docker ã«ã‚ˆã£ã¦ç®¡ç†ã•ã‚Œã¦ã„ã‚‹ãƒ›ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ä¸Šï¼ˆ**/var/lib/docker/volumes**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ï¼‰ã‚’ç¢ºèªã™ã‚‹ã¨ã€ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ä½œæˆã—ãŸ**test.txt**ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚ã‚ˆã£ã¦ã€ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ä½œæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã¯Docker ã«ã‚ˆã£ã¦ç®¡ç†ã•ã‚Œã¦ã„ã‚‹ãƒã‚¦ãƒ³ãƒˆå…ˆã«å­˜åœ¨ã™ã‚‹ã“ã¨ã«ãªã‚Šã€ã‚³ãƒ³ãƒ†ãƒŠãŒå‰Šé™¤ã•ã‚Œã€å†åº¦åˆ¥ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã—ã¦ã‚‚åŒã˜ãƒã‚¦ãƒ³ãƒˆå…ˆã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šæ°¸ç¶šåŒ–ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
$ sudo ls -ltr /var/lib/docker/volumes/vm1/_data
total 0
-rw-r--r--. 1 root root 0 Jan 31 21:26 test.txt
```

ä½œæˆã—ãŸãƒœãƒªãƒ¥ãƒ¼ãƒ ã¯ã€**docker volume rm**ã‚³ãƒãƒ³ãƒ‰ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§å‰Šé™¤ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
$ docker volume ls
DRIVER    VOLUME NAME
local     vm1

$ docker volume rm vm1
vm1

$ docker volume ls
DRIVER    VOLUME NAME
```

### bind mount

### tmpfs
tmpfsãƒã‚¦ãƒ³ãƒˆã¯ã€Linuxãƒ›ã‚¹ãƒˆãƒã‚·ãƒ³ä¸Šã®ãƒ¡ãƒ¢ãƒªç©ºé–“ä¸Šã«ãƒã‚¦ãƒ³ãƒˆã—ã¾ã™ã€‚ãƒ›ã‚¹ãƒˆãƒã‚·ãƒ³ä¸Šã®**ãƒ¡ãƒ¢ãƒª**ã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã‚¢ã‚¯ã‚»ã‚¹ã¯é«˜é€Ÿã«ãªã‚Šã¾ã™ãŒã€ã‚³ãƒ³ãƒ†ãƒŠã‚’åœæ­¢ã—ãŸã‚Šã€ãƒ›ã‚¹ãƒˆãƒã‚·ãƒ³ä¸Šã‚‚åœæ­¢ã‚„å†èµ·å‹•ã‚’ã™ã‚‹ã¨ãƒ‡ãƒ¼ã‚¿ãŒæ¶ˆãˆã¦ã—ã¾ã„ã¾ã™ã€‚
tmpfsãƒã‚¦ãƒ³ãƒˆã•ã›ã‚‹ãŸã‚ã«ã¯ã€**docker container run**ã‚³ãƒãƒ³ãƒ‰ã«ã€Œ--mountã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«**type=tmpfs**ã‚’æŒ‡å®šã—ã¾ã™ã€‚**target**ã¯ã€ä»Šå›ã‚‚**target=/home**ã¨ã—ã¾ã—ãŸã€‚ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•å¾Œã€ã‚³ãƒ³ãƒ†ãƒŠå†…ã§**df -h**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨**/home**é…ä¸‹ãŒtmpfsã‚’ãƒã‚¦ãƒ³ãƒˆã—ã¦ã„ã‚‹ã“ã¨ãŒã§ç¢ºèªã§ãã¾ã™ã€‚
```bash
$ docker container run -dit --name alpine-linux1 --mount type=tmpfs,target=/home alpine
c1ce74087a6284c6f2dafa849aaf1c562adb6353de2cbffc9226d56d72a5e9f4

$ docker container exec -it alpine-linux1 /bin/sh
/ # df -h
Filesystem                Size      Used Available Use% Mounted on
overlay                  19.7G      3.7G     16.1G  19% /
tmpfs                    64.0M         0     64.0M   0% /dev
shm                      64.0M         0     64.0M   0% /dev/shm
tmpfs                     1.8G         0      1.8G   0% /home
/dev/sda2                19.7G      3.7G     16.1G  19% /etc/resolv.conf
/dev/sda2                19.7G      3.7G     16.1G  19% /etc/hostname
/dev/sda2                19.7G      3.7G     16.1G  19% /etc/hosts
tmpfs                     1.8G         0      1.8G   0% /proc/acpi
tmpfs                    64.0M         0     64.0M   0% /proc/kcore
tmpfs                    64.0M         0     64.0M   0% /proc/keys
tmpfs                    64.0M         0     64.0M   0% /proc/timer_list
tmpfs                     1.8G         0      1.8G   0% /proc/scsi
tmpfs                     1.8G         0      1.8G   0% /sys/firmware
```